<!DOCTYPE html>
<html>
<head>
    <title>Firebase Auth Debug</title>
    <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase-auth.js"></script>
    <script src="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.css" />
</head>
<body>
    <h2>Firebase Auth Debug</h2>
    <div id="debug-info"></div>
    <hr>
    <div id="firebaseui-auth-container"></div>

    <script src="app/fireBase.js"></script>
    <script>
        // Debug info
        console.log("Firebase Config:", firebase.app().options);
        document.getElementById('debug-info').innerHTML = 
            '<strong>Project ID:</strong> ' + firebase.app().options.projectId + '<br>' +
            '<strong>Auth Domain:</strong> ' + firebase.app().options.authDomain + '<br>' +
            '<strong>API Key:</strong> ' + firebase.app().options.apiKey.substring(0, 10) + '...';

        // Test if we can check for existing users
        function testEmailExists(email) {
            firebase.auth().fetchSignInMethodsForEmail(email)
                .then(function(signInMethods) {
                    console.log('Sign-in methods for ' + email + ':', signInMethods);
                    if (signInMethods.length > 0) {
                        console.log('Email exists with methods:', signInMethods);
                    } else {
                        console.log('Email does not exist in this project');
                    }
                })
                .catch(function(error) {
                    console.error('Error checking email:', error);
                });
        }

        // FirebaseUI config with debug
        var uiConfig = {
            signInSuccessUrl: '../',
            signInOptions: [
                firebase.auth.EmailAuthProvider.PROVIDER_ID
            ],
            callbacks: {
                signInSuccessWithAuthResult: function(authResult, redirectUrl) {
                    console.log('Sign in successful:', authResult);
                    return true; // Redirect
                },
                signInFailure: function(error) {
                    console.error('Sign in failed:', error);
                }
            }
        };

        // Initialize FirebaseUI
        var ui = new firebaseui.auth.AuthUI(firebase.auth());
        ui.start('#firebaseui-auth-container', uiConfig);

        // Test with a specific email (replace with your email)
        // testEmailExists('your-test-email@example.com');
    </script>
</body>
</html>
